{"version":3,"file":"useSearchQuery.esm.js","sources":["../../../src/hooks/useSearchQuery/useSearchQuery.ts"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport { useEffect, useState, useMemo } from 'react';\nimport search, { PortEntity } from '../../api/search';\nimport { useApi, configApiRef } from '@backstage/core-plugin-api';\n\nconst tryJsonParse = (str: string) => {\n  try {\n    return JSON.parse(str);\n  } catch {\n    return null;\n  }\n};\n\nfunction useSearchQuery(searchQueryStr: string) {\n  const [data, setData] = useState<PortEntity[]>([]);\n  const [error, setError] = useState<string | null>();\n  const [isLoading, setIsLoading] = useState(false);\n  const config = useApi(configApiRef);\n  const backendUrl = useMemo(() => config.getString('backend.baseUrl'), []);\n\n  const searchQuery = tryJsonParse(searchQueryStr);\n\n  useEffect(() => {\n    setIsLoading(true);\n\n    search(backendUrl, searchQuery)\n      .then(entities => {\n        setData(entities);\n        setError(null);\n      })\n      .catch(() => {\n        setError('Failed fetching files');\n      })\n      .finally(() => {\n        setIsLoading(false);\n      });\n  }, [searchQueryStr]);\n\n  if (!searchQuery) {\n    return { data: [], error: null, isLoading: false };\n  }\n\n  return { data, error, isLoading };\n}\n\nexport default useSearchQuery;\n"],"names":[],"mappings":";;;;AAKA,MAAM,YAAA,GAAe,CAAC,GAAgB,KAAA;AACpC,EAAI,IAAA;AACF,IAAO,OAAA,IAAA,CAAK,MAAM,GAAG,CAAA,CAAA;AAAA,GACf,CAAA,MAAA;AACN,IAAO,OAAA,IAAA,CAAA;AAAA,GACT;AACF,CAAA,CAAA;AAEA,SAAS,eAAe,cAAwB,EAAA;AAC9C,EAAA,MAAM,CAAC,IAAM,EAAA,OAAO,CAAI,GAAA,QAAA,CAAuB,EAAE,CAAA,CAAA;AACjD,EAAA,MAAM,CAAC,KAAA,EAAO,QAAQ,CAAA,GAAI,QAAwB,EAAA,CAAA;AAClD,EAAA,MAAM,CAAC,SAAA,EAAW,YAAY,CAAA,GAAI,SAAS,KAAK,CAAA,CAAA;AAChD,EAAM,MAAA,MAAA,GAAS,OAAO,YAAY,CAAA,CAAA;AAClC,EAAM,MAAA,UAAA,GAAa,QAAQ,MAAM,MAAA,CAAO,UAAU,iBAAiB,CAAA,EAAG,EAAE,CAAA,CAAA;AAExE,EAAM,MAAA,WAAA,GAAc,aAAa,cAAc,CAAA,CAAA;AAE/C,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,YAAA,CAAa,IAAI,CAAA,CAAA;AAEjB,IAAA,MAAA,CAAO,UAAY,EAAA,WAAW,CAC3B,CAAA,IAAA,CAAK,CAAY,QAAA,KAAA;AAChB,MAAA,OAAA,CAAQ,QAAQ,CAAA,CAAA;AAChB,MAAA,QAAA,CAAS,IAAI,CAAA,CAAA;AAAA,KACd,CACA,CAAA,KAAA,CAAM,MAAM;AACX,MAAA,QAAA,CAAS,uBAAuB,CAAA,CAAA;AAAA,KACjC,CACA,CAAA,OAAA,CAAQ,MAAM;AACb,MAAA,YAAA,CAAa,KAAK,CAAA,CAAA;AAAA,KACnB,CAAA,CAAA;AAAA,GACL,EAAG,CAAC,cAAc,CAAC,CAAA,CAAA;AAEnB,EAAA,IAAI,CAAC,WAAa,EAAA;AAChB,IAAA,OAAO,EAAE,IAAM,EAAA,IAAI,KAAO,EAAA,IAAA,EAAM,WAAW,KAAM,EAAA,CAAA;AAAA,GACnD;AAEA,EAAO,OAAA,EAAE,IAAM,EAAA,KAAA,EAAO,SAAU,EAAA,CAAA;AAClC;;;;"}